<style>

body {
  font: 10px sans-serif;
}

.group-tick line {
  stroke: #000;
}

.chord {
  fill-opacity: 0.67
  stroke: none;
}

</style>
<svg width="960" height="3000">
 <linearGradient id="grad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:rgb(30,10,255);stop-opacity:1" />
      <stop offset="100%" style="stop-color:rgb(30,100,255);stop-opacity:1" />
    </linearGradient>
</svg>
<script src="https://d3js.org/d3.v4.min.js"></script>
<script>

function Chord(startx, starty, endx, endy, startWidth, endWidth, bend_len){
  this.startx = startx || 0;
  this.starty = starty;
  this.endx = endx;
  this.endy = endy;
  this.startWidth = startWidth || 0;
  this.endWidth = endWidth || startWidth;
  this.bend_len = bend_len || (endy - starty) / 2;
  this.path = function(){
    return "M" + this.startx + " " + this.starty + " C" + this.startx + " " 
              + (this.starty + this.bend_len) + " " + this.endx + " " 
              + (this.endy - this.bend_len) + " " + this.endx + " " 
              + this.endy + " L" + (this.endx + this.endWidth) + " " 
              + this.endy + " C" + (this.endx + this.endWidth) + " " 
              + (this.endy - this.bend_len) + " " + (this.startx + this.startWidth) 
              + " " + (this.starty + this.bend_len) + " " 
              + (this.startx + this.startWidth) + " " + this.starty + " L" 
              + this.startx + " " + this.starty + " Z";
  }
}

function Stream(startsize, splits, height, x_offset) {
  this.size = startsize;
  this.splits = splits;
  this.height = height || 1000;
  this.x_offset = x_offset || 100;
  this.path = function(svg){
    var split_l = this.height / (this.splits.length + 1);
    var main_width = this.size;
    var wiggle = 30;
    var chords = [new Chord(this.x_offset, 0, this.x_offset + wiggle, split_l, main_width)];
    var px = this.x_offset + wiggle;
    var py = split_l;
    for(var i = 0; i < this.splits.length; i++){
      main_width -= splits[i];
      if(wiggle < 0){
      chords.push(new Chord(px, py, px + wiggle, py + split_l, main_width));
      chords.push(new Chord(px + main_width, py, px + main_width - wiggle, py + split_l * 1.2, splits[i]));

      }else{
      chords.push(new Chord(splits[i] + px, py, splits[i] + px + wiggle, py + split_l, main_width));
      chords.push(new Chord(px, py, px - wiggle, py + split_l * 1.2, splits[i]));
      px += splits[i];
      }
      px += wiggle;
      py += split_l;
      wiggle *= -1;
    }
    return chords.reduce((acc, x) => acc + " " + x.path(), "");
  }

}

var svg = d3.select("svg");
var stream = new Stream(300, [40, 30, 20, 20, 10, 20, 30, 20, 15, 5, 30, 10, 30, 20], 3000);
svg.append("path")
.attr("class", "chord")
.attr("d", stream.path())
.attr("fill", "url(#grad)");

// var lst = [];
// lst.push(new Chord(40, 50, 50, 200, 100));
// lst.push(new Chord(50, 200, 40, 300, 10, 7, 30));
// lst.push(new Chord(130, 200, 140, 350, 20, 20));
// lst.push(new Chord(60, 200, 50, 400, 70));
// lst.push(new Chord(70, 400, 80, 500, 50));
// lst.push(new Chord(50, 400, 40, 500, 20));
// lst.push(new Chord(40, 500, 30, 550, 8, 7, 20));
// lst.push(new Chord(48, 500, 40, 580, 12));
// lst.push(new Chord(80, 500, 70, 600, 40));
// lst.push(new Chord(120, 500, 130, 580, 10));
// lst.push(new Chord(90, 600, 100, 750, 20));
// lst.push(new Chord(70, 600, 60, 700, 20));

// lst.push(new Chord(50, 500, 40, 600, 20));


// lst.push(new Chord(40, 50, 50, 180, 100));
// lst.push(new Chord(50, 180, 30, 280, 70));
// lst.push(new Chord(120, 180, 130, 280, 30));
// lst.push(new Chord(30, 280, 20, 380, 30));
// lst.push(new Chord(60, 280, 80, 380, 40));
// lst.push(new Chord(130, 280, 130, 380, 30));
// lst.push(new Chord(20, 380, 40, 480, 30));
// lst.push(new Chord(80, 380, 70, 480, 40));
// lst.push(new Chord(130, 380, 110, 480, 30));
// lst.push(new Chord(40, 480, 35, 540, 100, 110));

</script>